extends:
  - .lefthook/lefthook-commit-message.yml

pre-commit:
  parallel: true
  commands:
#    lint:
#      glob: "*.{js,ts,jsx,tsx}"
#      # denolint doesn't support providing multiple files via one command, so we cannot use {staged_files}
#      run: |
#        echo {staged_files}
#        for i in {staged_files}
#        do
#          echo "i $i"
#          npx --no-install denolint --config denolint.json $i
#        done
    format:
      # since dprint currently has some issues with formatting Dockerfiles, we don't do it during pre-commit
      # glob: "{Dockerfile,*.ts,*.tsx,*.js,*.jsx,*.cjs,*.mjs,*.json,*.md,*.toml}"
      glob: "{*.ts,*.tsx,*.js,*.jsx,*.cjs,*.mjs,*.json,*.md,*.toml}"
      exclude: ".*-lock.json|.*\/state\/.*"
      run: npx --no-install git-format-staged --formatter 'dprint fmt --stdin "{}"' {staged_files}
    tests:
      glob: "*.{ts,js}"
      exclude: ".*-lock.json|.*\/state\/.*"
      run: jest --passWithNoTests --findRelatedTests {staged_files}
